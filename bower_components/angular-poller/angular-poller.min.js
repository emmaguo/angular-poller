/*! angular-poller v0.4.5 16-08-2016 */
!function(a,b){"use strict";a.module("emguo.poller",[]).constant("pollerConfig",{stopOn:null,resetOn:null,smart:!1,neverOverwrite:!1,handleVisibilityChange:!1}).run(["$rootScope","$document","poller","pollerConfig",function(a,b,c,d){function e(a){return a&&("$stateChangeStart"===a||"$routeChangeStart"===a||"$stateChangeSuccess"===a||"$routeChangeSuccess"===a)}function f(){b.prop("hidden")?c.delayAll():c.resetDelay()}e(d.stopOn)&&a.$on(d.stopOn,function(){c.stopAll()}),e(d.resetOn)&&a.$on(d.resetOn,function(){c.reset()}),d.handleVisibilityChange&&(f(),b.on("visibilitychange",f))}]).factory("poller",["$interval","$q","$http","pollerConfig",function(c,d,e,f){function g(a,b){this.target=a,this.set(b)}function h(b){var c=null;return f.neverOverwrite||a.forEach(i,function(d){a.equals(d.target,b)&&(c=d)}),c}var i=[],j={action:"get",argumentsArray:[],delay:5e3,idleDelay:1e4,smart:f.smart,catchError:!1};return g.prototype.set=function(b){var c=["action","argumentsArray","delay","idleDelay","smart","catchError"];a.forEach(c,function(a){b&&b[a]?this[a]=b[a]:this[a]||(this[a]=j[a])},this),this.normalDelay=this.delay},g.prototype.start=function(){function b(){(!l||a.isUndefined(g)||g.$resolved)&&(f=a.isFunction(n.argumentsArray)?n.argumentsArray():n.argumentsArray.slice(0),a.isString(n.target)&&(f.unshift(n.target),i=e),h=new Date,g=i[j].apply(i,f),g.$resolved=!1,(g.$promise||g).then(function(b){g.$resolved=!0,(a.isUndefined(n.stopTimestamp)||h>=n.stopTimestamp)&&n.deferred.notify(b)},function(b){g.$resolved=!0,m&&(a.isUndefined(n.stopTimestamp)||h>=n.stopTimestamp)&&n.deferred.notify(b)}))}var f,g,h,i=this.target,j=this.action,k=this.delay,l=this.smart,m=this.catchError,n=this;this.deferred=this.deferred||d.defer(),b(),this.interval=c(b,k),this.promise=this.deferred.promise},g.prototype.stop=function(){a.isDefined(this.interval)&&(c.cancel(this.interval),this.interval=b,this.stopTimestamp=new Date)},g.prototype.remove=function(){var a=i.indexOf(this);this.stop(),i.splice(a,1)},g.prototype.restart=function(){this.stop(),this.start()},{get:function(a,b){var c=h(a);return c?(c.set(b),c.restart()):(c=new g(a,b),i.push(c),c.start()),c},size:function(){return i.length},stopAll:function(){a.forEach(i,function(a){a.stop()})},restartAll:function(){a.forEach(i,function(a){a.restart()})},reset:function(){this.stopAll(),i=[]},delayAll:function(){a.forEach(i,function(b){b.delay=b.idleDelay,a.isDefined(b.interval)&&b.restart()})},resetDelay:function(){a.forEach(i,function(b){b.delay=b.normalDelay,a.isDefined(b.interval)&&b.restart()})}}}])}(window.angular);